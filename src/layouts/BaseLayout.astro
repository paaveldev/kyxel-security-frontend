---
import '../styles/global.css';
import Navbar from '../components/nav/Navbar.astro';
import Footer from '../components/footer/Footer.astro';
import favicon from '../public/favicon.png';
import ogImage from '../public/logos/kyxelsecurity.png';

const {
  title = 'Kyxel Security â€” Real-time security telemetry',
  description = 'Kyxel Security monitors your servers, VPS and game hosts with live attack detection, enriched telemetry and actionable workflows.',
  showNav = true,
  showFooter = true,
} = Astro.props;

const canonical = Astro.site
  ? new URL(Astro.url.pathname, Astro.site).toString()
  : undefined;
---

<!doctype html>
<html lang="en" class="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    {canonical && <link rel="canonical" href={canonical} />}
    <meta name="description" content={description} />
    <!-- Favicon -->
    <link rel="icon" type="image/png" href={favicon.src} />
    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Kyxel Security" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage.src} />
    <meta property="og:image:alt" content="Kyxel Security brand mark" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage.src} />
    <meta name="theme-color" content="#030417" />
    <!-- Tailwind / global styles imported via ../styles/global.css -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="min-h-screen flex flex-col">
      {showNav && <Navbar />}
      <main class="flex-1">
        <slot />
      </main>
      {showFooter && <Footer />}
    </div>

    <script>
      (function () {
        const obs = new IntersectionObserver(
          (entries) => {
            entries.forEach((e) => {
              if (e.isIntersecting) e.target.classList.add('show');
            });
          },
          { threshold: 0.12 },
        );

        document.querySelectorAll('.reveal').forEach((el) => obs.observe(el));

        const header = document.querySelector('.site-header');
        if (header) {
          const onScroll = () => {
            if (window.scrollY > 40) header.classList.add('scrolled');
            else header.classList.remove('scrolled');
          };
          window.addEventListener('scroll', onScroll, { passive: true });
          onScroll();
        }
      })();
    </script>
  </body>
</html>
